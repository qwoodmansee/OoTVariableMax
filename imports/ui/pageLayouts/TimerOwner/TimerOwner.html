<!--Modals-->

<template name="TimerOwner">
    {{> GenerateTimerModal}}

    <div class="grey-darken-1">
        <div class="row">
            <h1 class="center" id="countdown" hidden>
                <span class="hours"></span>:<span class="minutes"></span>:<span class="seconds"></span>
            </h1>
            {{#if Template.subscriptionsReady}}
                {{#unless TimerRunning}}
                    <h1 class="center">{{UnactiveTimeFormatted.hours}}:{{UnactiveTimeFormatted.minutes}}:{{UnactiveTimeFormatted.seconds}}</h1>
                {{/unless}}
            {{/if}}
        </div>

        <ul class="collapsible grey darken-3 center" data-collapsible="expandable">
            <li>
                <div class="collapsible-header thin-header grey darken-3">Goals</div>
                <div class="collapsible-body">{{>GoalList}}</div>
            </li>
            <li>
                <div class="collapsible-header thin-header grey darken-3">Scorecard</div>
                <div class="collapsible-body">{{>Scorecard}}</div>
            </li>
        </ul>


        <!--must be outside of div so that can call jQuery on rendered and there will be no race condition-->
        <div class="row">
            <div class="col s6">
                <div class="center card-panel grey darken-3">
                    <div class="row">
                        <span class="center"> Owner Controls </span>
                    </div>
                    <div class="row">
                        {{#if TimerRunning}}
                            <button class="waves-effect waves-light btn-large red accent-2" id="timer-reset-button">Reset Timer</button>
                        {{else}}
                            <button class="waves-effect waves-light btn-large indigo" id="timer-start-button">Start Timer</button>
                        {{/if}}
                    </div>
                    <div class="row">
                        <a class="waves-effect waves-light btn-large pink lighten-1 modal-trigger" href="#generateModal">Generate New</a>
                    </div>
                    <div class="row">
                        {{#if CurrentlyRacing}}
                            <button class="waves-effect waves-light btn-large white black-text" id="leave-race-button">Leave Race</button>
                        {{else}}
                            <button class="waves-effect waves-light btn-large white black-text" id="join-race-button">Join Race</button>
                        {{/if}}
                    </div>
                    <div class="row">
                        <button class="waves-effect waves-light btn-large white black-text" id="popout-stream-layout-open">Stream Layout</button>
                    </div>
                </div>
            </div>
            <div class="col s6">
                <div class="center card-panel grey darken-3">
                    <table>
                        <thead>
                            <tr>
                                <th data-field="racers">Username</th>
                                <th data-field="scores">Score</th>
                                <th>Remove</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each viewer in PageViewers}}
                                {{#if viewer.currentlyRacing}}
                                    <tr>
                                        <td>{{viewer.username}}</td>
                                        <td>{{viewer.score}}</td>
                                        <td><i id="{{viewer.username}}-remove-button" class="remove-user mdi mdi-account-remove mdi-24px center pointer"></i></td>
                                    </tr>
                                {{/if}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="StreamLayoutPopout">
    <style media="screen" type="text/css">
        .score-card-container .scorecard-item {
            position: relative;
            cursor: pointer;
        }

        .score-card-container .scorecard-item .collected {
            opacity: 1;
        }

        .score-card-container .scorecard-icon {
            opacity: .25;
        }

        .weight-label {
            position: absolute;
            font-size: 1em;
            top: .9em;
            left: 2.2em;
            opacity: 1;
        }

    </style>
    <div class="grey darken-3 popout-stream-layout-background" style="height: 100vh; width: 100vw;">
        <div class="row" style="width: 100%; height: 75%">
            <div id="left-third" style="height: 100%; width: 21.375%; border: 1px solid white;
                display: inline-block; vertical-align: top;">
                <div class="grey darken-3 streamcard-background" style="height: 100%; width: 100%">
                    <div class="row streamcard-goals-container">
                        {{#each goals}}
                            {{#if complete}}
                                <div class="col s6 pointer" style="padding: 0 .25rem; margin-bottom: -.5em">
                                    <div class="card-panel streamcard-goal green white-text pointer">{{name}}</div>
                                </div>
                            {{else}}
                                {{#if inProgress}}
                                    <div class="col s6 pointer" style="padding: 0 .25rem; margin-bottom: -.5em">
                                        <div class="card-panel streamcard-goal red accent-2 white-text pointer">{{name}}</div>
                                    </div>
                                {{else}}
                                    {{#if required}}
                                        <div class="col s6 pointer" style="padding: 0 .25rem; margin-bottom: -.5em">
                                            <div class="card-panel streamcard-goal pink white-text pointer">{{name}}</div>
                                        </div>
                                    {{else}}
                                        <div class="col s6 pointer" style="padding: 0 .25rem; margin-bottom: -.5em">
                                            <div class="card-panel streamcard-goal indigo white-text pointer">{{name}}</div>
                                        </div>
                                    {{/if}}
                                {{/if}}
                            {{/if}}
                        {{/each}}
                    </div>
                </div>
            </div>
            <div id="video-third" style="background-color: black; height: 100%; width: 56.25%; border: 1px solid white;
                display: inline-block; vertical-align: top;">
            </div>
            <div id="right-third" style="height: 100%; width: 21.375%; border: 1px solid white;
                 display: inline-block; vertical-align: top;">
                <div class="row" style="width: 100%; height: 25%">
                    <div class="grey darken-3 streamcard-background" style="height: 100%; width: 100%">
                        <div class="row streamcard-score-container">
                            <p class="white-text center">Required: {{numGoalsRequired}}</p>
                            <p class="green-text center">Complete: {{numGoalsComplete}}</p>
                            <h3 class="white-text center">Score: {{Score}}</h3>
                        </div>

                        <div class="row streamcard-timer-container white-text">
                            <h1 class="center">{{timer.hours}}:{{timer.minutes}}:{{timer.seconds}}</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row" style="width: 100%; height: 25%;">
            {{>Scorecard}}
        </div>
    </div>
</template>

